// ========== KONFIGURASI ==========
const SHEET_NAME = "DataHutang"; // ganti jika nama sheet beda
const DRIVE_FOLDER_ID = "1gjfsx4IFRlad-zyD5xY4lSaOcl36DMlt"; // folder untuk simpan foto
// =================================

// Tampilkan form HTML
function doGet() {
  return HtmlService.createHtmlOutputFromFile('formHutang')
    .setTitle('Input Data Hutang')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}

// Terima data + file dari form
function doPost(e) {
  try {
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheetByName(SHEET_NAME);
    if (!sheet) {
      throw new Error("Sheet '" + SHEET_NAME + "' tidak ditemukan");
    }

    var folder = DriveApp.getFolderById(DRIVE_FOLDER_ID);

    // Ambil data text dari form (multipart/form-data)
    var barang = "";
    var harga = "";

    if (e.parameters) {
      barang = (e.parameters["Barang"] || [""])[0];
      harga = (e.parameters["Harga Barang"] || [""])[0];
    }

    // Ambil file foto (field name: 'photo')
    if (!e.files || !e.files["photo"]) {
      throw new Error("File foto (field 'photo') tidak ditemukan");
    }

    var photoBlob = e.files["photo"]; // sudah berupa Blob

    // Simpan ke Drive
    var createdFile = folder.createFile(photoBlob);
    createdFile.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);

    var photoUrl = createdFile.g
